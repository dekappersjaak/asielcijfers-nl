<!doctype html>
<html lang="nl">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Asielcijfers NL</title>
  <!-- Tailwind CSS via CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
</head>
<body class="bg-gray-50 text-gray-900">
  <!-- Header -->
  <header class="bg-white shadow">
    <div class="max-w-7xl mx-auto py-4 px-6">
      <h1 class="text-2xl font-bold">Asielcijfers NL</h1>
    </div>
  </header>

  <!-- Main content -->
  <main class="max-w-7xl mx-auto p-4">
    <!-- Hero -->
    <section class="bg-gradient-to-br from-blue-50 to-blue-100 p-6 rounded-lg shadow-md mb-8">
      <h2 class="text-xl font-medium text-gray-700 mb-2">Totaal asielaanvragen (2025)</h2>
      <div id="big-number" class="text-6xl font-extrabold mb-2">—</div>
      <p id="today-note" class="text-sm text-gray-600">Vandaag: —</p>
      <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 mt-4">
        <div class="p-4 bg-white rounded-lg shadow">
          <p class="text-sm text-gray-500">Statushouders (YTD)</p>
          <p id="ytd" class="text-2xl font-semibold">—</p>
        </div>
        <div class="p-4 bg-white rounded-lg shadow">
          <p class="text-sm text-gray-500">Toekenningen</p>
          <p id="toek" class="text-2xl font-semibold">—</p>
        </div>
        <div class="p-4 bg-white rounded-lg shadow">
          <p class="text-sm text-gray-500">Afwijzingen</p>
          <p id="afw" class="text-2xl font-semibold">—</p>
        </div>
      </div>
    </section>

    <!-- Tabs -->
    <section>
      <div class="flex space-x-2 mb-4">
        <button id="tab-origin" class="px-4 py-2 border border-gray-300 rounded-full text-gray-700 bg-white font-medium">Herkomst (dit jaar)</button>
        <button id="tab-status" class="px-4 py-2 border border-gray-300 rounded-full text-gray-700 bg-white font-medium">Opname statushouders (meerjaren)</button>
      </div>
      <div id="panel-origin">
        <canvas id="originChart" height="220"></canvas>
        <p class="text-xs text-gray-500 mt-2">Bron: IND/UNHCR/CBS</p>
      </div>
      <div id="panel-status" class="hidden">
        <canvas id="statusChart" height="220"></canvas>
        <p class="text-xs text-gray-500 mt-2">Bron: CBS/IND</p>
      </div>
    </section>
  </main>

  <!-- Footer -->
  <footer class="bg-white mt-12 py-4">
    <div class="max-w-7xl mx-auto text-sm text-gray-500 px-4">
      <p>Data gebaseerd op officiële cijfers van IND en CBS; schattingen worden separaat gemarkeerd.</p>
    </div>
  </footer>

  <!-- Scripts -->
  <script>
    const fmt = (n) => {
      if (n >= 1e6) return (n / 1e6).toFixed(1) + 'm';
      if (n >= 1e3) return (n / 1e3).toFixed(1) + 'k';
      return n.toLocaleString('nl-NL');
    };
    async function loadJSON(url) {
      const r = await fetch(url);
      return r.json();
    }
    (async () => {
      // Hero
      const totals = await loadJSON('/data/totals.json');
      document.getElementById('big-number').textContent = fmt(totals.asielaanvragen);
      document.getElementById('today-note').textContent = `Vandaag: +${fmt(totals.vandaag_schatting)} (schatting)`;
      document.getElementById('ytd').textContent = fmt(totals.statushouders_ytd);
      document.getElementById('toek').textContent = fmt(totals.toekenningen);
      document.getElementById('afw').textContent = fmt(totals.afwijzingen);

      // Origin chart
      const originData = (await loadJSON('/data/origin_2025.json')).sort((a,b) => b.aantal - a.aantal).slice(0,10);
      new Chart(document.getElementById('originChart'), {
        type: 'bar',
        data: { labels: originData.map(d => d.land), datasets: [{ data: originData.map(d => d.aantal) }] },
        options: {
          indexAxis: 'y',
          plugins: { legend: { display: false }, tooltip: { callbacks: { label: c => fmt(c.raw) } } },
          scales: { x: { ticks: { callback: v => fmt(v) } } }
        }
      });

      // Status chart
      const hist = await loadJSON('/data/statushouders_history.json');
      new Chart(document.getElementById('statusChart'), {
        type: 'line',
        data: { labels: hist.map(d => d.jaar), datasets: [{ data: hist.map(d => d.opgenomen), fill: false, tension: 0.3 }] },
        options: {
          plugins: { legend: { display: false }, tooltip: { callbacks: { label: c => fmt(c.raw) } } },
          scales: { y: { ticks: { callback: v => fmt(v) } } }
        }
      });

      // Tab toggling
      const tabOrigin = document.getElementById('tab-origin');
      const tabStatus = document.getElementById('tab-status');
      const panelOrigin = document.getElementById('panel-origin');
      const panelStatus = document.getElementById('panel-status');

      function activateTab(originActive) {
        if (originActive) {
          panelOrigin.classList.remove('hidden');
          panelStatus.classList.add('hidden');
          tabOrigin.classList.add('bg-blue-500','text-white');
          tabOrigin.classList.remove('bg-white','text-gray-700');
          tabStatus.classList.add('bg-white','text-gray-700');
          tabStatus.classList.remove('bg-blue-500','text-white');
        } else {
          panelStatus.classList.remove('hidden');
          panelOrigin.classList.add('hidden');
          tabStatus.classList.add('bg-blue-500','text-white');
          tabStatus.classList.remove('bg-white','text-gray-700');
          tabOrigin.classList.add('bg-white','text-gray-700');
          tabOrigin.classList.remove('bg-blue-500','text-white');
        }
      }

      tabOrigin.addEventListener('click', () => activateTab(true));
      tabStatus.addEventListener('click', () => activateTab(false));
      // Initial state
      activateTab(true);
    })();
  </script>
</body>
</html>
