<!doctype html>
<html lang="nl">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Asielcijfers NL</title>
  <!-- Tailwind CSS voor responsieve lay-out -->
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@3.4.1/dist/tailwind.min.css" rel="stylesheet">
  <!-- Chart.js voor grafieken -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
</head>
<body class="bg-gray-50 text-gray-900">

  <!-- Header -->
  <header class="bg-white shadow">
    <div class="max-w-7xl mx-auto py-4 px-6">
      <h1 class="text-2xl font-bold">Asielcijfers NL</h1>
    </div>
  </header>

  <!-- Main content -->
  <main class="max-w-7xl mx-auto p-4">
    <!-- Hero / Teller -->
    <section class="bg-gradient-to-br from-blue-50 to-blue-100 p-6 rounded-lg shadow mb-8">
      <h2 class="text-xl font-medium text-gray-700 mb-2">Totaal asielaanvragen (2025)</h2>
      <div id="big-number" class="text-6xl font-extrabold mb-2">—</div>
      <p id="today-note" class="text-sm text-gray-600">Vandaag: —</p>
      <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 mt-4">
        <div class="p-4 bg-white rounded-lg shadow">
          <p class="text-sm text-gray-500">Statushouders (YTD)</p>
          <p id="ytd" class="text-2xl font-semibold">—</p>
        </div>
        <div class="p-4 bg-white rounded-lg shadow">
          <p class="text-sm text-gray-500">Toekenningen</p>
          <p id="toek" class="text-2xl font-semibold">—</p>
        </div>
        <div class="p-4 bg-white rounded-lg shadow">
          <p class="text-sm text-gray-500">Afwijzingen</p>
          <p id="afw" class="text-2xl font-semibold">—</p>
        </div>
      </div>
    </section>

    <!-- Tabs voor grafieken -->
    <section>
      <div class="flex space-x-2 mb-4">
        <button id="tab-origin" class="px-4 py-2 bg-white border border-gray-300 rounded-full text-gray-700 font-medium">Herkomst (dit jaar)</button>
        <button id="tab-status" class="px-4 py-2 bg-white border border-gray-300 rounded-full text-gray-700 font-medium">Opname statushouders (meerjaren)</button>
      </div>

      <!-- Panel herkomstlanden -->
      <div id="panel-origin">
        <canvas id="originChart" height="220"></canvas>
        <p class="text-xs text-gray-500 mt-2">Bron: IND/UNHCR/CBS</p>
      </div>

      <!-- Panel statushouders geschiedenis -->
      <div id="panel-status" class="hidden">
        <canvas id="statusChart" height="220"></canvas>
        <p class="text-xs text-gray-500 mt-2">Bron: CBS/IND</p>
      </div>
    </section>
  </main>

  <!-- Footer -->
  <footer class="bg-white mt-12 py-4">
    <div class="max-w-7xl mx-auto text-sm text-gray-500 px-4">
      <p>Data gebaseerd op officiële cijfers van IND en CBS; schattingen worden separaat gemarkeerd.</p>
    </div>
  </footer>

  <!-- Script: laad data en teken grafieken -->
  <script>
    // Getallen formatteren
    const fmt = n => {
      if (n >= 1e6) return (n / 1e6).toFixed(1) + 'm';
      if (n >= 1e3) return (n / 1e3).toFixed(1) + 'k';
      return n.toLocaleString('nl-NL');
    };
    async function loadJSON(url) {
      const r = await fetch(url);
      return r.json();
    }

    (async () => {
      // Hero teller vullen
      const totals = await loadJSON('/data/totals.json');
      document.getElementById('big-number').textContent = fmt(totals.asielaanvragen);
      document.getElementById('today-note').textContent = `Vandaag: +${fmt(totals.vandaag_schatting)} (schatting)`;
      document.getElementById('ytd').textContent = fmt(totals.statushouders_ytd);
      document.getElementById('toek').textContent = fmt(totals.toekenningen);
      document.getElementById('afw').textContent = fmt(totals.afwijzingen);

      // Herkomstlanden (top-10) laden en tekenen
      const origin = (await loadJSON('/data/origin_2025.json'))
        .sort((a,b) => b.aantal - a.aantal).slice(0,10);
      new Chart(document.getElementById('originChart'), {
        type: 'bar',
        data: { labels: origin.map(d => d.land), datasets: [{ data: origin.map(d => d.aantal) }] },
        options: {
          indexAxis: 'y',
          plugins: { legend: { display: false }, tooltip: { callbacks: { label: c => fmt(c.raw) } } },
          scales: { x: { ticks: { callback: v => fmt(v) } } }
        }
      });

      // Meerjaren-grafiek statushouders laden en tekenen
      const hist = await loadJSON('/data/statushouders_history.json');
      new Chart(document.getElementById('statusChart'), {
        type: 'line',
        data: { labels: hist.map(d => d.jaar), datasets: [{ data: hist.map(d => d.opgenomen), fill: false, tension: 0.3 }] },
        options: {
          plugins: { legend: { display: false }, tooltip: { callbacks: { label: c => fmt(c.raw) } } },
          scales: { y: { ticks: { callback: v => fmt(v) } } }
        }
      });

      // Tabs wisselen
      const tabO = document.getElementById('tab-origin');
      const tabS = document.getElementById('tab-status');
      const panelO = document.getElementById('panel-origin');
      const panelS = document.getElementById('panel-status');
      function showOrigin() {
        panelO.classList.remove('hidden');
        panelS.classList.add('hidden');
        tabO.classList.add('bg-gray-200');
        tabS.classList.remove('bg-gray-200');
      }
      function showStatus() {
        panelS.classList.remove('hidden');
        panelO.classList.add('hidden');
        tabS.classList.add('bg-gray-200');
        tabO.classList.remove('bg-gray-200');
      }
      tabO.addEventListener('click', showOrigin);
      tabS.addEventListener('click', showStatus);
      // Start met herkomst
      showOrigin();
    })();
  </script>
</body>
</html>
